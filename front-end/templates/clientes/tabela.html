<!-- front-end/templates/clientes/tabela.html -->
<div class="table-responsive">
    <table class="table table-hover agro-table">
        <thead>
            <tr>
                <th>
                    <a href="#" 
                       hx-get="/clientes?ordenar_por=id&direcao={{if eq .OrdenarPor "id"}}{{if eq .Direcao "ASC"}}DESC{{else}}ASC{{end}}{{else}}DESC{{end}}&busca={{.Busca}}"
                       hx-target="#clientes-container"
                       class="text-decoration-none d-flex align-items-center gap-1">
                        ID
                        {{if eq .OrdenarPor "id"}}
                            <i class="fas fa-sort-{{if eq .Direcao "ASC"}}up{{else}}down{{end}} small"></i>
                        {{else}}
                            <i class="fas fa-sort small text-muted"></i>
                        {{end}}
                    </a>
                </th>
                <th>
                    <a href="#" 
                       hx-get="/clientes?ordenar_por=nome&direcao={{if eq .OrdenarPor "nome"}}{{if eq .Direcao "ASC"}}DESC{{else}}ASC{{end}}{{else}}DESC{{end}}&busca={{.Busca}}"
                       hx-target="#clientes-container"
                       class="text-decoration-none d-flex align-items-center gap-1">
                        Nome
                        {{if eq .OrdenarPor "nome"}}
                            <i class="fas fa-sort-{{if eq .Direcao "ASC"}}up{{else}}down{{end}} small"></i>
                        {{else}}
                            <i class="fas fa-sort small text-muted"></i>
                        {{end}}
                    </a>
                </th>
                <th>CPF/CNPJ</th>
                <th>Telefone</th>
                <th>E-mail</th>
                <th>
                    <a href="#" 
                       hx-get="/clientes?ordenar_por=data_cadastro&direcao={{if eq .OrdenarPor "data_cadastro"}}{{if eq .Direcao "ASC"}}DESC{{else}}ASC{{end}}{{else}}DESC{{end}}&busca={{.Busca}}"
                       hx-target="#clientes-container"
                       class="text-decoration-none d-flex align-items-center gap-1">
                        Data Cadastro
                        {{if eq .OrdenarPor "data_cadastro"}}
                            <i class="fas fa-sort-{{if eq .Direcao "ASC"}}up{{else}}down{{end}} small"></i>
                        {{else}}
                            <i class="fas fa-sort small text-muted"></i>
                        {{end}}
                    </a>
                </th>
                <th class="text-end">Ações</th>
            </tr>
        </thead>
        <tbody>
            {{range .Clientes}}
            <tr>
                <td><span class="badge bg-secondary">#{{.ID}}</span></td>
                <td>
                    <div class="d-flex align-items-center gap-2">
                        <div class="avatar-circle-sm bg-primary text-white">
                            {{index (split .Nome " ") 0 | firstLetter}}
                        </div>
                        <strong>{{.Nome}}</strong>
                    </div>
                </td>
                <td>{{.CpfCnpj | formatCPFCNPJ}}</td>
                <td>{{.Telefone | formatPhone}}</td>
                <td>{{.Email}}</td>
                <td>{{formatDate "02/01/2006" .DataCadastro}}</td>
                <td class="text-end">
                    <div class="btn-group btn-group-sm" role="group">
                        <a href="/clientes/detalhes?id={{.ID}}" 
                           class="btn btn-outline-info"
                           hx-get="/clientes/detalhes?id={{.ID}}"
                           hx-target="#main-content"
                           hx-push-url="true"
                           title="Detalhes">
                            <i class="fas fa-eye"></i>
                        </a>
                        <a href="/clientes/editar?id={{.ID}}" 
                           class="btn btn-outline-primary"
                           hx-get="/clientes/editar?id={{.ID}}"
                           hx-target="#main-content"
                           hx-push-url="true"
                           title="Editar">
                            <i class="fas fa-edit"></i>
                        </a>
                        <button class="btn btn-outline-danger"
                                hx-delete="/clientes/excluir?id={{.ID}}"
                                hx-target="#clientes-container"
                                hx-confirm="Tem certeza que deseja excluir este cliente?"
                                title="Excluir">
                            <i class="fas fa-trash"></i>
                        </button>
                    </div>
                </td>
            </tr>
            {{else}}
            <tr>
                <td colspan="7" class="text-center py-5">
                    <div class="text-muted">
                        <i class="fas fa-users fa-3x mb-3"></i>
                        <h5>Nenhum cliente encontrado</h5>
                        {{if .Busca}}
                            <p class="mb-3">Nenhum resultado para "{{.Busca}}"</p>
                            <button class="btn btn-outline-secondary btn-sm"
                                    hx-get="/clientes"
                                    hx-target="#clientes-container">
                                Limpar busca
                            </button>
                        {{else}}
                            <p class="mb-3">Comece cadastrando seu primeiro cliente</p>
                            <a href="/clientes/novo" 
                               class="btn btn-primary"
                               hx-get="/clientes/novo"
                               hx-target="#main-content"
                               hx-push-url="true">
                                <i class="fas fa-user-plus me-2"></i>Novo Cliente
                            </a>
                        {{end}}
                    </div>
                </td>
            </tr>
            {{end}}
        </tbody>
    </table>
</div>

{{if gt .TotalRegistros 0}}
<!-- Paginação -->
<nav aria-label="Navegação de páginas">
    <ul class="pagination justify-content-center mb-0">
        <!-- Primeira página -->
        {{if gt .PaginaAtual 1}}
        <li class="page-item">
            <a class="page-link" 
               href="#"
               hx-get="/clientes?pagina=1&busca={{.Busca}}&ordenar_por={{.OrdenarPor}}&direcao={{.Direcao}}"
               hx-target="#clientes-container"
               aria-label="Primeira">
                <i class="fas fa-angle-double-left"></i>
            </a>
        </li>
        <li class="page-item">
            <a class="page-link" 
               href="#"
               hx-get="/clientes?pagina={{sub .PaginaAtual 1}}&busca={{.Busca}}&ordenar_por={{.OrdenarPor}}&direcao={{.Direcao}}"
               hx-target="#clientes-container"
               aria-label="Anterior">
                <i class="fas fa-angle-left"></i>
            </a>
        </li>
        {{else}}
        <li class="page-item disabled">
            <span class="page-link"><i class="fas fa-angle-double-left"></i></span>
        </li>
        <li class="page-item disabled">
            <span class="page-link"><i class="fas fa-angle-left"></i></span>
        </li>
        {{end}}

        <!-- Números das páginas -->
        {{range .Paginas}}
        <li class="page-item {{if eq . $.PaginaAtual}}active{{end}}">
            <a class="page-link" 
               href="#"
               hx-get="/clientes?pagina={{.}}&busca={{$.Busca}}&ordenar_por={{$.OrdenarPor}}&direcao={{$.Direcao}}"
               hx-target="#clientes-container">
                {{.}}
            </a>
        </li>
        {{end}}

        <!-- Próxima página -->
        {{if lt .PaginaAtual .TotalPaginas}}
        <li class="page-item">
            <a class="page-link" 
               href="#"
               hx-get="/clientes?pagina={{add .PaginaAtual 1}}&busca={{.Busca}}&ordenar_por={{.OrdenarPor}}&direcao={{.Direcao}}"
               hx-target="#clientes-container"
               aria-label="Próxima">
                <i class="fas fa-angle-right"></i>
            </a>
        </li>
        <li class="page-item">
            <a class="page-link" 
               href="#"
               hx-get="/clientes?pagina={{.TotalPaginas}}&busca={{.Busca}}&ordenar_por={{.OrdenarPor}}&direcao={{.Direcao}}"
               hx-target="#clientes-container"
               aria-label="Última">
                <i class="fas fa-angle-double-right"></i>
            </a>
        </li>
        {{else}}
        <li class="page-item disabled">
            <span class="page-link"><i class="fas fa-angle-right"></i></span>
        </li>
        <li class="page-item disabled">
            <span class="page-link"><i class="fas fa-angle-double-right"></i></span>
        </li>
        {{end}}
    </ul>
    
    <div class="text-center text-muted small mt-2">
        Mostrando {{len .Clientes}} de {{.TotalRegistros}} clientes
        {{if .Busca}} • Busca: "{{.Busca}}"{{end}}
    </div>
</nav>
{{end}}
