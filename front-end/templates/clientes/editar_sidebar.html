<!-- front-end/templates/clientes/editar_sidebar.html -->
<div class="container-fluid">
    <!-- Formulário de edição -->
    <form method="POST" action="/clientes/salvar"
          hx-post="/clientes/salvar"
          hx-target="#clientes-container"
          hx-swap="innerHTML"
          hx-on:after-request="if(event.detail.successful) closeSidebar()">
        
        <input type="hidden" name="id" value="{{.Cliente.ID}}">
        
        <div class="mb-4">
            <h4 class="mb-3">{{.Title}}</h4>
            <p class="text-muted mb-0">Preencha os dados do cliente abaixo</p>
        </div>
        
        <!-- Mensagens de erro -->
        <div id="form-errors"></div>
        
        <div class="row g-3">
            <!-- Nome -->
            <div class="col-12">
                <label for="nome" class="form-label">Nome Completo *</label>
                <input type="text" class="form-control" id="nome" name="nome" 
                       value="{{.Cliente.Nome}}" required autofocus>
            </div>
            
            <!-- CPF/CNPJ e Telefone -->
            <div class="col-md-6">
                <label for="cpf_cnpj" class="form-label">CPF/CNPJ *</label>
                <input type="text" class="form-control" id="cpf_cnpj" name="cpf_cnpj" 
                       value="{{.Cliente.CpfCnpj}}" required
                       oninput="formatarDocumento(this)">
                <div class="form-text">Digite apenas números</div>
            </div>
            
            <div class="col-md-6">
                <label for="telefone" class="form-label">Telefone *</label>
                <input type="tel" class="form-control" id="telefone" name="telefone" 
                       value="{{.Cliente.Telefone}}" required
                       oninput="formatarTelefone(this)">
            </div>
            
            <!-- Email -->
            <div class="col-12">
                <label for="email" class="form-label">E-mail</label>
                <input type="email" class="form-control" id="email" name="email" 
                       value="{{.Cliente.Email}}">
            </div>
            
            <!-- Endereço -->
            <div class="col-12">
                <label for="endereco" class="form-label">Endereço</label>
                <input type="text" class="form-control" id="endereco" name="endereco" 
                       value="{{.Cliente.Endereco}}">
            </div>
            
            <!-- Cidade e Estado -->
            <div class="col-md-8">
                <label for="cidade" class="form-label">Cidade</label>
                <input type="text" class="form-control" id="cidade" name="cidade" 
                       value="{{.Cliente.Cidade}}">
            </div>
            
            <div class="col-md-4">
                <label for="estado" class="form-label">Estado</label>
                <select class="form-select" id="estado" name="estado">
                    <option value="">Selecione...</option>
                    {{range .Estados}}
                    <option value="{{.}}" {{if eq . $.Cliente.Estado}}selected{{end}}>
                        {{.}}
                    </option>
                    {{end}}
                </select>
            </div>
            
            <!-- Observações -->
            <div class="col-12">
                <label for="observacoes" class="form-label">Observações</label>
                <textarea class="form-control" id="observacoes" name="observacoes" 
                          rows="3">{{.Cliente.Observacoes}}</textarea>
            </div>
        </div>
        
        <!-- Footer do formulário -->
        <div class="mt-5 pt-4 border-top">
            <div class="d-flex justify-content-between">
                <button type="button" class="btn btn-outline-secondary" onclick="closeSidebar()">
                    Cancelar
                </button>
                <button type="submit" class="btn btn-primary">
                    <i class="fas fa-save me-2"></i>
                    {{if .Cliente.ID}}Atualizar Cliente{{else}}Cadastrar Cliente{{end}}
                </button>
            </div>
        </div>
    </form>
</div>

<script>
    // Inicializar formatação dos campos
    document.addEventListener('DOMContentLoaded', function() {
        const cpfCnpjInput = document.getElementById('cpf_cnpj');
        const telefoneInput = document.getElementById('telefone');
        
        if (cpfCnpjInput) {
            cpfCnpjInput.addEventListener('input', function() {
                formatarDocumento(this);
            });
        }
        
        if (telefoneInput) {
            telefoneInput.addEventListener('input', function() {
                formatarTelefone(this);
            });
        }
    });
</script>
